<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT Trainer - Zahlensysteme</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect, useCallback } = React;

        // Hilfskomponente für Icons (da Lucide in React-CDN anders funktioniert)
        const Icon = ({ name, size = 24, className = "", fill = "none" }) => {
            const [iconHtml, setIconHtml] = useState("");
            useEffect(() => {
                if (window.lucide) {
                    const icon = window.lucide.icons[name];
                    if (icon) {
                        const svg = icon.toSvg({ 
                            width: size, 
                            height: size, 
                            class: className,
                            fill: fill,
                            'stroke-width': 2
                        });
                        setIconHtml(svg);
                    }
                }
            }, [name, size, className, fill]);
            return <span dangerouslySetInnerHTML={{ __html: iconHtml }} />;
        };

        const BINARY_LOGIC = {
            formatBinary: (binStr) => {
                if (typeof binStr !== 'string' || !/^[01]+$/.test(binStr)) return binStr;
                const reversed = binStr.split('').reverse().join('');
                const chunks = reversed.match(/.{1,4}/g);
                return chunks ? chunks.join(' ').split('').reverse().join('') : binStr;
            },
            createTasks: (diff) => {
                const tasks = [];
                const countPerSide = 10;
                for (let i = 0; i < countPerSide * 2; i++) {
                    let decimal, question, answer, label;
                    const isBinToDec = i >= countPerSide;
                    if (diff === 'G') {
                        decimal = Math.floor(Math.random() * 64);
                        question = isBinToDec ? decimal.toString(2).padStart(6, '0') : decimal;
                        answer = isBinToDec ? decimal.toString() : decimal.toString(2).padStart(6, '0');
                        label = isBinToDec ? 'Binär → Dezimal' : 'Dezimal → Binär (6 Bit)';
                    } else if (diff === 'M') {
                        decimal = Math.floor(Math.random() * 256);
                        question = isBinToDec ? decimal.toString(2).padStart(8, '0') : decimal;
                        answer = isBinToDec ? decimal.toString() : decimal.toString(2).padStart(8, '0');
                        label = isBinToDec ? 'Binär → Dezimal' : 'Dezimal → Binär (8 Bit)';
                    } else {
                        const mode = Math.random();
                        if (mode < 0.4) {
                            decimal = Math.floor(Math.random() * 4096);
                            question = isBinToDec ? decimal.toString(2).padStart(12, '0') : decimal;
                            answer = isBinToDec ? decimal.toString() : decimal.toString(2).padStart(12, '0');
                            label = isBinToDec ? 'Binär → Dezimal (12 Bit)' : 'Dezimal → Binär (12 Bit)';
                        } else if (mode < 0.7) {
                            decimal = Math.floor(Math.random() * 256);
                            question = isBinToDec ? decimal.toString(16).toUpperCase() : decimal;
                            answer = isBinToDec ? decimal.toString() : decimal.toString(16).toUpperCase();
                            label = isBinToDec ? 'Hex → Dezimal' : 'Dezimal → Hex';
                        } else {
                            decimal = Math.floor(Math.random() * 256) - 128;
                            const bit8 = (decimal < 0 ? (Math.pow(2, 8) + decimal) : decimal).toString(2).padStart(8, '0');
                            question = isBinToDec ? bit8 : decimal;
                            answer = isBinToDec ? decimal.toString() : bit8;
                            label = isBinToDec ? '2er-Komplement → Dez' : 'Dez → 2er-Komplement';
                        }
                    }
                    tasks.push({ question, answer: answer.toString(), label });
                }
                return tasks.sort(() => Math.random() - 0.5);
            }
        };

        const App = () => {
            const [view, setView] = useState('welcome');
            const [user, setUser] = useState({ name: '', progress: { G: 0, M: 0, E: 0 } });
            const [difficulty, setDifficulty] = useState('G');
            const [session, setSession] = useState({ tasks: [], currentIndex: 0, score: 0, isActive: false });
            const [userInput, setUserInput] = useState('');
            const [feedback, setFeedback] = useState(null);

            const generateRandomName = () => {
                const adj = ['Binärer', 'Logischer', 'Digitaler', 'Bit-Schiebender', 'Vernetzter'];
                const noun = ['Bot', 'Cursor', 'Pixel', 'Kernel', 'Algo'];
                setUser(prev => ({ ...prev, name: `${adj[Math.floor(Math.random() * adj.length)]} ${noun[Math.floor(Math.random() * noun.length)]}` }));
            };

            const startTraining = (lvl) => {
                const tasks = BINARY_LOGIC.createTasks(lvl);
                setDifficulty(lvl);
                setSession({ tasks, currentIndex: 0, score: 0, isActive: true });
                setFeedback(null);
                setUserInput('');
                setView('exercise');
            };

            const handleCheck = () => {
                const current = session.tasks[session.currentIndex];
                const cleanIn = userInput.trim().replace(/\s+/g, '').toUpperCase();
                const cleanAns = current.answer.replace(/\s+/g, '').toUpperCase();
                if (cleanIn === cleanAns) {
                    setFeedback({ correct: true, val: current.answer });
                    setSession(s => ({ ...s, score: s.score + 1 }));
                } else {
                    setFeedback({ correct: false, val: current.answer });
                }
            };

            const handleNext = () => {
                if (session.currentIndex < 19) {
                    setSession(s => ({ ...s, currentIndex: s.currentIndex + 1 }));
                    setFeedback(null);
                    setUserInput('');
                } else {
                    setUser(prev => ({ 
                        ...prev, 
                        progress: { ...prev.progress, [difficulty]: prev.progress[difficulty] + session.score } 
                    }));
                    setSession(s => ({ ...s, isActive: false }));
                    setView('summary');
                }
            };

            const qrUrl = useMemo(() => {
                const data = JSON.stringify({ name: user.name, scores: user.progress });
                return `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(data)}&bgcolor=0f172a&color=f8fafc`;
            }, [user]);

            return (
                <div className="min-h-screen bg-slate-950 text-slate-100 flex flex-col overflow-x-hidden selection:bg-blue-500/30">
                    <div className="fixed inset-0 bg-[radial-gradient(circle_at_50%_0%,_rgba(30,58,138,0.1),transparent)] pointer-events-none"></div>

                    <main className="relative z-10 w-full max-w-4xl mx-auto px-6 py-12 flex-1 flex flex-col justify-center text-center">
                        
                        {view === 'welcome' && (
                            <div className="flex flex-col items-center">
                                <div className="bg-blue-600 p-6 rounded-[2.5rem] shadow-2xl mb-8 transform -rotate-3">
                                    <Icon name="Binary" size={64} className="text-white" />
                                </div>
                                <h1 className="text-5xl font-black mb-4 uppercase tracking-tighter text-white">IT Trainer</h1>
                                <p className="text-slate-400 mb-12 text-lg">Meistere die Welt der Informatik.</p>
                                <div className="bg-slate-900 border border-slate-800 p-8 rounded-[3rem] w-full max-w-md shadow-2xl">
                                    <div className="flex gap-2 mb-6">
                                        <input 
                                            type="text" value={user.name} onChange={(e) => setUser({...user, name: e.target.value})}
                                            placeholder="Dein Alias..." className="flex-1 bg-slate-950 border border-slate-700 rounded-xl px-5 py-4 text-white focus:ring-2 focus:ring-blue-500 outline-none font-bold"
                                        />
                                        <button onClick={generateRandomName} className="p-4 bg-slate-800 hover:bg-slate-700 rounded-xl text-slate-300 transition-colors">
                                            <Icon name="Dices" size={24} />
                                        </button>
                                    </div>
                                    <button 
                                        disabled={!user.name} onClick={() => setView('dashboard')}
                                        className="w-full bg-blue-600 hover:bg-blue-500 disabled:opacity-20 py-5 rounded-2xl font-black text-white uppercase tracking-widest"
                                    >
                                        Starten
                                    </button>
                                </div>
                            </div>
                        )}

                        {view === 'dashboard' && (
                            <div className="w-full">
                                <header className="flex justify-between items-center mb-12">
                                    <div className="text-left">
                                        <p className="text-slate-500 font-bold uppercase tracking-widest text-[10px]">Dashboard</p>
                                        <h2 className="text-3xl font-black text-white">{user.name}</h2>
                                    </div>
                                    <button onClick={() => setView('stats')} className="p-4 bg-slate-900 border border-slate-800 rounded-2xl text-slate-300 hover:text-white transition-all">
                                        <Icon name="BarChart3" size={28} />
                                    </button>
                                </header>

                                {session.isActive && (
                                    <div className="mb-10 p-8 bg-blue-600/10 border border-blue-500/20 rounded-[2.5rem] flex flex-col md:flex-row items-center justify-between gap-6">
                                        <div className="flex items-center gap-6 text-left">
                                            <div className="bg-blue-600 p-4 rounded-2xl text-white shadow-lg"><Icon name="Play" size={28} fill="currentColor" /></div>
                                            <div><h4 className="font-black text-white text-xl uppercase tracking-tight">Übung pausiert</h4><p className="text-slate-400 font-medium">Aufgabe {session.currentIndex + 1} / 20</p></div>
                                        </div>
                                        <button onClick={() => setView('exercise')} className="bg-blue-600 hover:bg-blue-500 text-white font-black px-10 py-4 rounded-2xl uppercase tracking-widest">Fortfahren</button>
                                    </div>
                                )}

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                    <div onClick={() => setView('level-select')} className="group bg-slate-900 border border-slate-800 p-10 rounded-[3rem] hover:border-blue-500 hover:bg-slate-800/50 cursor-pointer transition-all text-left">
                                        <div className="bg-blue-600 w-16 h-16 rounded-[1.25rem] flex items-center justify-center mb-8 text-white shadow-xl group-hover:rotate-6 transition-transform">
                                            <Icon name="Hash" size={32} />
                                        </div>
                                        <h3 className="text-2xl font-black text-white mb-2 uppercase tracking-tight">Zahlensysteme</h3>
                                        <p className="text-slate-400 mb-8 text-sm">Wandle Zahlen in 20er-Sessions um. G, M und E Niveau.</p>
                                        <span className="text-blue-500 font-black uppercase tracking-widest text-xs flex items-center gap-2">Wählen <Icon name="ChevronRight" size={16} /></span>
                                    </div>
                                    <div className="bg-slate-900/30 border-2 border-dashed border-slate-800 p-10 rounded-[3rem] flex flex-col items-center justify-center text-slate-700 opacity-40">
                                        <Icon name="LayoutGrid" size={48} className="mb-4" />
                                        <p className="text-xs font-black uppercase tracking-widest">Demnächst</p>
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'level-select' && (
                            <div className="w-full text-left">
                                <button onClick={() => setView('dashboard')} className="mb-10 flex items-center gap-2 text-slate-500 hover:text-white font-black uppercase text-xs tracking-widest">
                                    <Icon name="ArrowLeft" size={20} /> Zurück
                                </button>
                                <h2 className="text-4xl font-black text-white mb-10 uppercase tracking-tighter">Wähle dein Niveau</h2>
                                <div className="space-y-4">
                                    {[
                                        { id: 'G', title: 'Grundlegend (G)', desc: 'Bis 63. Mit Hilfe.', color: 'border-l-blue-600' },
                                        { id: 'M', title: 'Mittler (M)', desc: 'Bis 255. Standard.', color: 'border-l-purple-600' },
                                        { id: 'E', title: 'Erweitert (E)', desc: 'Hex & 2er-Komplement.', color: 'border-l-emerald-600' }
                                    ].map(lvl => (
                                        <button key={lvl.id} onClick={() => startTraining(lvl.id)} className={`w-full flex items-center justify-between p-8 bg-slate-900 border border-slate-800 rounded-[2rem] hover:bg-slate-800 border-l-[12px] ${lvl.color} transition-all group`}>
                                            <div><h4 className="text-2xl font-black text-white uppercase">{lvl.title}</h4><p className="text-slate-500 text-sm">{lvl.desc}</p></div>
                                            <Icon name="ChevronRight" size={32} className="text-slate-700 group-hover:text-white" />
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {view === 'exercise' && (
                            <div className="w-full">
                                <div className="flex justify-between items-center mb-6">
                                    <button onClick={() => setView('dashboard')} className="p-3 bg-slate-900 border border-slate-800 rounded-xl text-slate-400 hover:text-white flex items-center gap-2 font-black uppercase text-[10px] tracking-widest">
                                        <Icon name="ArrowLeft" size={18} /> Pause
                                    </button>
                                    <div className="text-right">
                                        <p className="text-slate-500 font-bold text-[10px] uppercase tracking-widest">{difficulty}-Niveau</p>
                                        <p className="text-white font-mono font-bold text-lg">{session.currentIndex + 1} / 20</p>
                                    </div>
                                </div>
                                <div className="w-full bg-slate-900 h-2 rounded-full mb-10 overflow-hidden border border-slate-800">
                                    <div className="h-full bg-blue-600 transition-all duration-700" style={{ width: `${((session.currentIndex + 1) / 20) * 100}%` }}></div>
                                </div>
                                
                                <div className="bg-slate-900 border border-slate-800 rounded-[3.5rem] p-12 md:p-16 shadow-2xl relative text-center">
                                    <span className="bg-blue-600/10 text-blue-400 px-5 py-2 rounded-full text-[10px] font-black uppercase tracking-widest border border-blue-500/20 mb-8 inline-block">
                                        {session.tasks[session.currentIndex].label}
                                    </span>
                                    <div className="text-5xl md:text-7xl font-mono font-black text-white mb-16 break-all tracking-tighter">
                                        {BINARY_LOGIC.formatBinary(session.tasks[session.currentIndex].question.toString())}
                                    </div>
                                    
                                    {!feedback ? (
                                        <div className="space-y-8 max-w-sm mx-auto">
                                            <input 
                                                type="text" value={userInput} autoFocus 
                                                onChange={(e) => setUserInput(e.target.value)} 
                                                onKeyDown={(e) => e.key === 'Enter' && handleCheck()} 
                                                className="w-full bg-slate-950 border-4 border-slate-800 rounded-[2rem] px-8 py-8 text-4xl font-mono text-center focus:border-blue-600 outline-none text-white tracking-widest transition-all" 
                                                placeholder="?" 
                                            />
                                            <button onClick={handleCheck} className="w-full bg-blue-600 hover:bg-blue-500 text-white font-black py-6 rounded-2xl shadow-xl uppercase tracking-widest">Prüfen</button>
                                        </div>
                                    ) : (
                                        <div className={`p-10 rounded-[3rem] border-4 ${feedback.correct ? 'bg-emerald-500/5 border-emerald-500/30' : 'bg-red-500/5 border-red-500/30'}`}>
                                            <div className="flex items-center justify-center gap-5 mb-8">
                                                {feedback.correct ? <Icon name="CheckCircle2" className="text-emerald-500" size={48} /> : <Icon name="XCircle" className="text-red-500" size={48} />}
                                                <h4 className={`text-4xl font-black ${feedback.correct ? 'text-emerald-400' : 'text-red-400'} uppercase`}>
                                                    {feedback.correct ? 'Richtig!' : 'Falsch'}
                                                </h4>
                                            </div>
                                            {!feedback.correct && (
                                                <div className="mb-10">
                                                    <p className="text-slate-500 font-bold uppercase text-xs mb-2">Lösung:</p>
                                                    <span className="font-mono font-black text-white text-4xl block bg-slate-950 p-6 rounded-2xl border border-slate-800">
                                                        {BINARY_LOGIC.formatBinary(feedback.val)}
                                                    </span>
                                                </div>
                                            )}
                                            <button onClick={handleNext} className="w-full bg-white text-slate-950 font-black py-6 rounded-2xl flex items-center justify-center gap-3 uppercase tracking-widest text-lg hover:bg-slate-100 transition-all">
                                                Weiter <Icon name="ChevronRight" size={24} />
                                            </button>
                                        </div>
                                    )}

                                    {difficulty === 'G' && !feedback && (
                                        <div className="mt-16 bg-slate-950/50 rounded-[2.5rem] p-8 border border-slate-800 text-left">
                                            <div className="flex items-center gap-2 mb-6 text-blue-400 font-black text-[10px] uppercase tracking-widest">
                                                <Icon name="Info" size={16} /> Stellenwert-Hilfe
                                            </div>
                                            <div className="grid grid-cols-6 gap-3">
                                                {[32, 16, 8, 4, 2, 1].map((v, i) => (
                                                    <div key={v} className="p-3 rounded-2xl bg-slate-900 border border-slate-800 text-center">
                                                        <p className="text-[10px] text-slate-600 font-mono">2^{5-i}</p>
                                                        <p className="text-xl font-black text-blue-300">{v}</p>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        )}

                        {view === 'summary' && (
                            <div className="py-16 flex flex-col items-center">
                                <div className="w-32 h-32 bg-yellow-500 rounded-full flex items-center justify-center mb-10 shadow-2xl">
                                    <Icon name="Trophy" size={64} className="text-white" />
                                </div>
                                <h2 className="text-5xl font-black text-white mb-2 uppercase tracking-tighter">Fertig!</h2>
                                <p className="text-slate-500 mb-12 text-lg">Hervorragend auf {difficulty}-Niveau.</p>
                                <div className="bg-slate-900 border-2 border-slate-800 p-12 rounded-[3.5rem] w-full max-w-lg mb-12 shadow-2xl relative overflow-hidden">
                                    <div className="absolute top-0 left-0 w-full h-2 bg-blue-600"></div>
                                    <p className="text-slate-600 font-black uppercase tracking-widest text-[10px] mb-6">Dein Ergebnis</p>
                                    <div className="text-9xl font-black text-blue-500">{session.score}<span className="text-4xl text-slate-700">/20</span></div>
                                </div>
                                <button onClick={() => setView('dashboard')} className="bg-blue-600 hover:bg-blue-500 text-white font-black px-16 py-6 rounded-[2rem] uppercase tracking-widest text-lg">Dashboard</button>
                            </div>
                        )}

                        {view === 'stats' && (
                            <div className="py-12 text-left">
                                <button onClick={() => setView('dashboard')} className="mb-12 flex items-center gap-3 text-slate-500 hover:text-white font-black uppercase text-xs tracking-widest">
                                    <Icon name="ArrowLeft" size={20} /> Dashboard
                                </button>
                                <h2 className="text-5xl font-black text-white mb-12 uppercase tracking-tighter">Dein Progress</h2>
                                <div className="grid gap-4 mb-12">
                                    {['G', 'M', 'E'].map(lvl => (
                                        <div key={lvl} className="bg-slate-900 border border-slate-800 p-8 rounded-[2.5rem] flex justify-between items-center relative overflow-hidden shadow-xl">
                                            <div className={`absolute left-0 top-0 bottom-0 w-3 ${lvl === 'G' ? 'bg-blue-500' : lvl === 'M' ? 'bg-purple-500' : 'bg-emerald-500'}`}></div>
                                            <span className="text-2xl font-black text-white ml-4 uppercase">{lvl}-Niveau</span>
                                            <div className="text-right font-mono font-black text-4xl text-blue-400">{user.progress[lvl]} <span className="text-xs text-slate-700 uppercase">Pkt</span></div>
                                        </div>
                                    ))}
                                </div>
                                <div className="bg-slate-900 p-12 rounded-[4rem] border border-slate-800 flex flex-col items-center">
                                    <div className="bg-white p-6 rounded-[3rem] mb-10"><img src={qrUrl} alt="QR-Code Progress" className="w-56 h-56" /></div>
                                    <p className="text-slate-500 text-sm text-center font-bold uppercase tracking-widest opacity-60">Scanne den Code für andere Geräte.</p>
                                </div>
                            </div>
                        )}
                    </main>

                    <footer className="py-10 text-[10px] font-black uppercase tracking-[0.4em] text-slate-800 opacity-50 text-center">© 2026 IT Trainer Open Source Project</footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
